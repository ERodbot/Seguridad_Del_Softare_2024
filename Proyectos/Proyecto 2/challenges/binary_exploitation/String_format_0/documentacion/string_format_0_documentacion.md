Instituto Tecnológico de Costa Rica 
Seguridad del Software
Proyecto #2 
#### Reto: Nombre del reto



<!DOCTYPE html>
<html>
<head>
<style>
  body {
    margin: 20px 
  }
  .box {
    border: 1px solid #000;
    padding: 10px;
    margin: 0px 5px 0px 5px;
  }
  .header {
    font-weight: bold;
    color: #FFFFF;
  }
  .content {
    color: #0000FF;
  }
  .img {
    margin: 20px 0px 20px 0px
    px;
  }

</style>
</head>
<body>



<div></div>
<div class="box">
  <div class="header">Responsable:</div>
  <div class="content">
    <p>Esteban Leiva Montenegro</p>
  </div>
</div>

<div class="box">
  <div class="header">Puntos:</div>
  <div class="content">
    <p>50</p>
  </div>
</div>

<div class="box">
  <div class="header">Categoría:</div>
  <div class="content">
    <p>Binary Exploitation</p>
  </div>
</div>

<div class="box">
  <div class="header">Empezado:</div>
  <div class="content">
    <p>20/05/2024</p>
  </div>
</div>


<div class="box">
  <div class="header">Terminado:</div>
  <div class="content">
    <p>20/05/2024</p>
  </div>
</div>

<div class="box">
  <div class="header">Procedimiento</div>
  <div class="content">
      <p>Inicialmente, se observa el código 'format-string-0' proporcionado para el reto, en el que se observan dos buffers distintos, uno para enteros y otro para caracteres</p>
      <img src= "images\img_format_string_0_1.png" class="img"/>
      <p>Es importante señalar los tamaños de ambos buffers, 32 y 64 respectivamente. Además, se observan las funciones de 'serve_patrick' y 'serve_bob'. En estas, se tienen varias opciones, entre las que se encuentran 'Gr%114d_Cheese' para la función 'serve_patrick' y 'Cla%sic_Che%s%steak' para la función 'serve_bob'.</p>
      <img src= "images\img_format_string_0_2.png" class="img"/>
      <img src= "images\img_format_string_0_3.png" class="img"/>
      <p>Es imprescindible explicar los especificadores de los caracteres especiales en la función printf utilizada para imprimir las respuestas</p>
      <img src= "images\img_format_string_0_4.png" 
      class="img"/>
      <p>Los formatos de '%d' y '%s' se utilizan como 'placeholders' para rellenarse dentro del string de entrada en la función, donde se utilizan el resto de los parámetros aportados a printf además del string. En este caso, al no proporcionarse argumentos para rellenar pero sí placeholders, sucede que la función retorna los elementos de la pila que se encuentren donde deberían estar los argumentos, esencialmente derramando información de la memoria.</p>
      <p> Esto se explota al saber que la función 'serve_patrick' comprueba que la cuenta de caracteres impresos no sea mayor que dos veces el tamaño del buffer. Al estar utilizando el formato de string '%114' se copian las posiciones de la pila como 114 enteros, mucho más de los 32 enteros del tamaño del buffer. </p>
      <p>Al cumplirse la primera condición, se llama a 'serve_bob'. En esta función, cuando se selecciona la opción 'Gr%114d_Cheese' se está utilizando el especificador '%s' en tres ocaciones, esto termina por darnos 3 valores de la pila como strings, entre los cuales se encuentra guardada la bandera del reto </p>
      <img src= "images\img_format_string_0_5.png" 
      class="img"/>


  </div>
</div>

<div class="box">
  <div class="header">Herramientas utilizadas</div>
  <div class="content">
    <p>Terminal Zsh </p>
  </div>
</div>

<div class="box">
  <div class="header">CWE del reto:</div>
  <div class="content">
    <p>CWE-20: Improper Input Validation</p>
    <p>The product receives input or data, but it does not validate or incorrectly validates that the input has the properties that are required to process the data safely and correctly.</p>
  </div>
</div>

<div class="box">
  <div class="header">Patrón CAPEC utilizado:</div>
  <div class="content">
    <p>CAPEC-135: Format String Injection</p>
    <p>An adversary includes formatting characters in a string input field on the target application. Most applications assume that users will provide static text and may respond unpredictably to the presence of formatting character. For example, in certain functions of the C programming languages such as printf, the formatting character %s will print the contents of a memory location expecting this location to identify a string and the formatting character %n prints the number of DWORD written in the memory. An adversary can use this to read or write to memory locations or files, or simply to manipulate the value of the resulting text in unexpected ways. Reading or writing memory may result in program crashes and writing memory could result in the execution of arbitrary code if the adversary can write to the program stack.</p>
  </div>
</div>

<div class="box">
  <div class="header">Bandera</div>
  <div class="content">
    <p>picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}</p>
  </div>
</div>

</body>
</html>
